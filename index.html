<!--
Code generated by chatGPT, using the following prompt:

create a html file that includes javascript code to download an auto-generated csv file when a link is clicked. 
The csv file should contain two columns of data, time and amplitude, for a simulated signal. 
The signal should be the absolute value of a sine wave with a frequency randomly selected between 2 and 10 hertz, with an amplitude between fifteen and thirty decibels. 
The signal should be obscured by random noise that is roughly ten percent of the amplitude. 
The signal should last a random amount of time, between three and five seconds, and contain 1000 samples per second. The first row of the csv file should contain headers "Time (s)" and "Amplitude (dB)".

Some minor adjustments were made by Mr. Connors.
-->

<html>
  <head>
    <title>Signal Generator</title>
  </head>
  <body>
    <h1>Signal Generator</h1>
    <p>Click the link below to download a CSV file with a simulated signal:</p>
    <p>(A new csv file will be generated each time the page is refreshed.)</p>
    <a href="#" id="download-link">Download CSV</a>
    
    <script>
      // Set up variables for the signal generator
      const frequencyMin = 2; // Hz
      const frequencyMax = 14; // Hz
      const amplitudeMin = 15; // W/m^2
      const amplitudeMax = 30; // W/m^2
      const noiseLevel = 0.2; // fraction of amplitude
      const durationMin = 3; // seconds
      const durationMax = 12; // seconds
      const sampleRate = 1000; // samples per second
      
      // Generate a random frequency and amplitude for the signal
      const frequency = Math.random() * (frequencyMax - frequencyMin) + frequencyMin;
      const amplitude = Math.random() * (amplitudeMax - amplitudeMin) + amplitudeMin;
      
      // Calculate the duration of the signal
      const duration = Math.random() * (durationMax - durationMin) + durationMin;
      
      // Create an array to hold the data for the CSV file
      const data = [];
      
      // Add the headers to the data array
      data.push(["Time (s)", "Amplitude (W/m^2)"]);
      
      // Generate the data for the CSV file
      for (let i = 0; i < duration * sampleRate; i++) {
        // Calculate the time for this sample
        const time = i / sampleRate;
        
        // Calculate the amplitude of the sine wave at this time
        const sine = Math.abs(Math.sin(2 * Math.PI * frequency * time));
        
        // Calculate the noise level for this sample
        const noise = (Math.random() - 0.5) * noiseLevel * amplitude;
        
        // Calculate the total amplitude for this sample
        const value = sine * amplitude + noise;
        
        // Add this sample to the data array
        data.push([time, value]);
      }
      
      // Set up the download link to generate the CSV file when clicked
      const link = document.getElementById("download-link");
      link.addEventListener("click", () => {
        // Create a CSV string from the data array
        const csv = data.map(row => row.join(",")).join("\n");
        
        // Create a blob containing the CSV data
        const blob = new Blob([csv], {type: "text/csv"});
        
        // Create a URL for the blob
        const url = URL.createObjectURL(blob);
        
        // Set the href of the download link to the URL of the blob
        link.href = url;
        
        // Set the download attribute of the link to a suggested file name
        link.download = "signal.csv";
      });
    </script>
  </body>
</html>
